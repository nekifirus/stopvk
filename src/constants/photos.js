var PHOTOARRVK = [{
  "id": 428753463,
  "album_id": -7,
  "owner_id": -97357221,
  "user_id": 100,
  "photo_75": "https://pp.userapi.com/c626620/v626620638/27325/XUhunHACvIE.jpg",
  "photo_130": "https://pp.userapi.com/c626620/v626620638/27326/wv0EcMSrBrA.jpg",
  "photo_604": "https://pp.userapi.com/c626620/v626620638/27327/rogFcYlq7-8.jpg",
  "photo_807": "https://pp.userapi.com/c626620/v626620638/27328/WVuYc-Wn7ME.jpg",
  "photo_1280": "https://pp.userapi.com/c626620/v626620638/27329/3r7zQVZoVps.jpg",
  "width": 1280,
  "height": 793,
  "text": "",
  "date": 1473428252,
  "access_key": "aa81e42b71173edb81"
}, {
  "id": 433446695,
  "album_id": -7,
  "owner_id": 5445842,
  "photo_75": "https://pp.userapi.com/c631724/v631724842/4544d/_47_c4cIIP0.jpg",
  "photo_130": "https://pp.userapi.com/c631724/v631724842/4544e/DaBU3LSb48U.jpg",
  "photo_604": "https://pp.userapi.com/c631724/v631724842/4544f/NsJCCrcRoB0.jpg",
  "photo_807": "https://pp.userapi.com/c631724/v631724842/45450/9gDglLg-NtA.jpg",
  "photo_1280": "https://pp.userapi.com/c631724/v631724842/45451/esi48V577PU.jpg",
  "width": 1080,
  "height": 1080,
  "text": "",
  "date": 1473365233,
  "post_id": 1588,
  "access_key": "9e8e3fade1cec939f8"
}, {
  "id": 433446857,
  "album_id": -7,
  "owner_id": 5445842,
  "photo_75": "https://pp.userapi.com/c631724/v631724842/45456/ibFV0tRz1uQ.jpg",
  "photo_130": "https://pp.userapi.com/c631724/v631724842/45457/5IZ7Q579QFg.jpg",
  "photo_604": "https://pp.userapi.com/c631724/v631724842/45458/3dfKy8Tooio.jpg",
  "photo_807": "https://pp.userapi.com/c631724/v631724842/45459/CybJXr4eLa8.jpg",
  "photo_1280": "https://pp.userapi.com/c631724/v631724842/4545a/jXN0P_rjuRg.jpg",
  "width": 1080,
  "height": 1080,
  "text": "",
  "date": 1473365320,
  "post_id": 1589,
  "access_key": "ff620e7e2259ac65a4"
}, {
  "id": 433447150,
  "album_id": -7,
  "owner_id": 5445842,
  "photo_75": "https://pp.userapi.com/c631724/v631724842/45468/EUDhe_SOAJc.jpg",
  "photo_130": "https://pp.userapi.com/c631724/v631724842/45469/AnGbJ9okppQ.jpg",
  "photo_604": "https://pp.userapi.com/c631724/v631724842/4546a/xMTZgeCraHU.jpg",
  "photo_807": "https://pp.userapi.com/c631724/v631724842/4546b/49b_oT-uNig.jpg",
  "photo_1280": "https://pp.userapi.com/c631724/v631724842/4546c/xD2HtYLayNA.jpg",
  "width": 1080,
  "height": 1080,
  "text": "",
  "date": 1473365449,
  "post_id": 1591,
  "access_key": "f7230e387944a08153"
}, {
  "id": 433447674,
  "album_id": -7,
  "owner_id": 5445842,
  "photo_75": "https://pp.userapi.com/c631724/v631724842/45471/pUBhtBn7OdE.jpg",
  "photo_130": "https://pp.userapi.com/c631724/v631724842/45472/iYnnyJxD7sY.jpg",
  "photo_604": "https://pp.userapi.com/c631724/v631724842/45473/SHuCW23cPKU.jpg",
  "photo_807": "https://pp.userapi.com/c631724/v631724842/45474/hAzqjpIsmiw.jpg",
  "width": 640,
  "height": 640,
  "text": "",
  "date": 1473365678,
  "post_id": 1592,
  "access_key": "b8777cf174844ae54c"
}, {
  "id": 428941663,
  "album_id": -7,
  "owner_id": 13839334,
  "photo_75": "https://pp.userapi.com/c630723/v630723912/4b86b/nibIUiAqnSc.jpg",
  "photo_130": "https://pp.userapi.com/c630723/v630723912/4b86c/e8rlg3r2SlE.jpg",
  "photo_604": "https://pp.userapi.com/c630723/v630723912/4b86d/zH3MpnQAyXA.jpg",
  "photo_807": "https://pp.userapi.com/c630723/v630723912/4b86e/AVwMzJq6ioA.jpg",
  "photo_1280": "https://pp.userapi.com/c630723/v630723912/4b86f/p__f-Mz5CM0.jpg",
  "photo_2560": "https://pp.userapi.com/c630723/v630723912/4b870/sJOZocp9X4c.jpg",
  "width": 2560,
  "height": 1583,
  "text": "",
  "date": 1472064869,
  "post_id": 2357,
  "access_key": "8e1b691b22ed78717d"
}, {
  "id": 424495705,
  "album_id": -7,
  "owner_id": -119719115,
  "user_id": 100,
  "photo_75": "https://pp.userapi.com/c604330/v604330593/18cf4/g1MAWfIaDmU.jpg",
  "photo_130": "https://pp.userapi.com/c604330/v604330593/18cf5/fIrUVb7zN74.jpg",
  "photo_604": "https://pp.userapi.com/c604330/v604330593/18cf6/iI-GkK8CjWI.jpg",
  "photo_807": "https://pp.userapi.com/c604330/v604330593/18cf7/MEy4NN9fG4o.jpg",
  "photo_1280": "https://pp.userapi.com/c604330/v604330593/18cf8/0ZPPUPl51gY.jpg",
  "width": 960,
  "height": 720,
  "text": "",
  "date": 1469857780,
  "lat": 51.240439,
  "long": 58.452429,
  "post_id": 661,
  "access_key": "da1f1dccbaa70e277f"
}, {
  "id": 424854200,
  "album_id": -15,
  "owner_id": 1518656,
  "photo_75": "https://pp.userapi.com/c631529/v631529345/3d119/2VSIYg8gIsI.jpg",
  "photo_130": "https://pp.userapi.com/c631529/v631529345/3d11a/MkXXxAf3syQ.jpg",
  "photo_604": "https://pp.userapi.com/c631529/v631529345/3d11b/A_n5yh95C2g.jpg",
  "photo_807": "https://pp.userapi.com/c631529/v631529345/3d11c/rHG-oHW2xko.jpg",
  "photo_1280": "https://pp.userapi.com/c631529/v631529345/3d11d/MVV9yQskkbw.jpg",
  "photo_2560": "https://pp.userapi.com/c631529/v631529345/3d11e/DqRFUhCt3k4.jpg",
  "width": 1472,
  "height": 991,
  "text": "",
  "date": 1469349447,
  "post_id": 1799,
  "access_key": "9f7011e262ed821d71"
}, {
  "id": 424105723,
  "album_id": 197079933,
  "owner_id": 16864345,
  "photo_75": "https://pp.userapi.com/c631529/v631529345/3d119/2VSIYg8gIsI.jpg",
  "photo_130": "https://pp.userapi.com/c631529/v631529345/3d11a/MkXXxAf3syQ.jpg",
  "photo_604": "https://pp.userapi.com/c631529/v631529345/3d11b/A_n5yh95C2g.jpg",
  "photo_807": "https://pp.userapi.com/c631529/v631529345/3d11c/rHG-oHW2xko.jpg",
  "photo_1280": "https://pp.userapi.com/c631529/v631529345/3d11d/MVV9yQskkbw.jpg",
  "photo_2560": "https://pp.userapi.com/c631529/v631529345/3d11e/DqRFUhCt3k4.jpg",
  "width": 1472,
  "height": 991,
  "text": "",
  "date": 1469272269,
  "access_key": "1c8d2a5078f4a226b2"
}, {
  "id": 418797085,
  "album_id": 229779022,
  "owner_id": 100282,
  "photo_75": "https://pp.userapi.com/c630416/v630416282/35c06/hvJRgVMTEcM.jpg",
  "photo_130": "https://pp.userapi.com/c630416/v630416282/35c07/ciq7P_G_C4U.jpg",
  "photo_604": "https://pp.userapi.com/c630416/v630416282/35c08/ZgiG64pDsaM.jpg",
  "photo_807": "https://pp.userapi.com/c630416/v630416282/35c09/NyXuN4Dgk18.jpg",
  "photo_1280": "https://pp.userapi.com/c630416/v630416282/35c0a/OreWEHwlM2A.jpg",
  "photo_2560": "https://pp.userapi.com/c630416/v630416282/35c0b/YpGOFvc5TPA.jpg",
  "width": 2560,
  "height": 1707,
  "text": "И под каждым им кустом был готов и стол и дом.",
  "date": 1465149873,
  "access_key": "8c8a0386c1bfe3ccb9"
}, {
  "id": 418798379,
  "album_id": 229779022,
  "owner_id": 100282,
  "photo_75": "https://pp.userapi.com/c630416/v630416282/35c92/GWuwHcrlpeU.jpg",
  "photo_130": "https://pp.userapi.com/c630416/v630416282/35c93/tBQcqncCyIs.jpg",
  "photo_604": "https://pp.userapi.com/c630416/v630416282/35c94/QBQFGIxhRYg.jpg",
  "photo_807": "https://pp.userapi.com/c630416/v630416282/35c95/vk3QhcSqF5A.jpg",
  "photo_1280": "https://pp.userapi.com/c630416/v630416282/35c96/EfI1u9urNfg.jpg",
  "photo_2560": "https://pp.userapi.com/c630416/v630416282/35c97/2wCkPpHrWTo.jpg",
  "width": 2560,
  "height": 1707,
  "text": "",
  "date": 1465150357,
  "access_key": "b3f92403c2dd0c5580"
}, {
  "id": 411728772,
  "album_id": -6,
  "owner_id": 86201585,
  "photo_75": "https://pp.userapi.com/c604530/v604530318/5d98/Ne0rsICGsQk.jpg",
  "photo_130": "https://pp.userapi.com/c604530/v604530318/5d99/lj8C3VrF22A.jpg",
  "photo_604": "https://pp.userapi.com/c604530/v604530318/5d9a/8zJjbNsLcSg.jpg",
  "photo_807": "https://pp.userapi.com/c604530/v604530318/5d9b/2Xg0FHaAFmo.jpg",
  "photo_1280": "https://pp.userapi.com/c604530/v604530318/5d9c/gyTyeSbuaTA.jpg",
  "photo_2560": "https://pp.userapi.com/c604530/v604530318/5d9d/WY8R5H5jNZg.jpg",
  "width": 1300,
  "height": 867,
  "text": "",
  "date": 1461443705,
  "post_id": 874
}, {
  "id": 411936234,
  "album_id": 229779022,
  "owner_id": 100282,
  "photo_75": "https://pp.userapi.com/c636425/v636425282/26b2/KrYXUmWp8mE.jpg",
  "photo_130": "https://pp.userapi.com/c636425/v636425282/26b3/8YXhr-vTmSI.jpg",
  "photo_604": "https://pp.userapi.com/c636425/v636425282/26b4/h3H9xgWXljg.jpg",
  "photo_807": "https://pp.userapi.com/c636425/v636425282/26b5/3mEZM065rFs.jpg",
  "photo_1280": "https://pp.userapi.com/c636425/v636425282/26b6/rUBlIPD0bnQ.jpg",
  "photo_2560": "https://pp.userapi.com/c636425/v636425282/26b7/nK6ixehqckg.jpg",
  "width": 2560,
  "height": 1706,
  "text": "Смеркалось",
  "date": 1460991613,
  "access_key": "4860010ab3c6f810ba"
}, {
  "id": 410839461,
  "album_id": 229779022,
  "owner_id": 100282,
  "photo_75": "https://pp.userapi.com/c628016/v628016282/4e495/x8--yd2JmyQ.jpg",
  "photo_130": "https://pp.userapi.com/c628016/v628016282/4e496/iPDQj35LrXk.jpg",
  "photo_604": "https://pp.userapi.com/c628016/v628016282/4e497/9QES0CxKjHE.jpg",
  "photo_807": "https://pp.userapi.com/c628016/v628016282/4e498/GIrr5AYD4AU.jpg",
  "photo_1280": "https://pp.userapi.com/c628016/v628016282/4e499/aZZQXlVZk08.jpg",
  "photo_2560": "https://pp.userapi.com/c628016/v628016282/4e49a/Yky87_1D_7U.jpg",
  "width": 2560,
  "height": 1707,
  "text": "",
  "date": 1460306559,
  "access_key": "94e9c9ef83640e2050"
}, {
  "id": 410841551,
  "album_id": 229779022,
  "owner_id": 100282,
  "photo_75": "https://pp.userapi.com/c628016/v628016282/4e521/Z_UaE60JUzU.jpg",
  "photo_130": "https://pp.userapi.com/c628016/v628016282/4e522/Gl-gZ8Mnrxs.jpg",
  "photo_604": "https://pp.userapi.com/c628016/v628016282/4e523/wQvqWYoY87E.jpg",
  "photo_807": "https://pp.userapi.com/c628016/v628016282/4e524/5XI7z0wvaGU.jpg",
  "photo_1280": "https://pp.userapi.com/c628016/v628016282/4e525/p3eLBooZbJE.jpg",
  "photo_2560": "https://pp.userapi.com/c628016/v628016282/4e526/jia1xE7IkzE.jpg",
  "width": 2560,
  "height": 1707,
  "text": "Скользко",
  "date": 1460307200,
  "access_key": "0c395f05939e417571"
}, {
  "id": 410840453,
  "album_id": 229779022,
  "owner_id": 100282,
  "photo_75": "https://pp.userapi.com/c628016/v628016282/4e4b3/kXvFvB9SjPY.jpg",
  "photo_130": "https://pp.userapi.com/c628016/v628016282/4e4b4/3nVgfxHeQUw.jpg",
  "photo_604": "https://pp.userapi.com/c628016/v628016282/4e4b5/R58pU4cfTno.jpg",
  "photo_807": "https://pp.userapi.com/c628016/v628016282/4e4b6/m9xCc2L8qjE.jpg",
  "photo_1280": "https://pp.userapi.com/c628016/v628016282/4e4b7/tj8HVnk3u3M.jpg",
  "photo_2560": "https://pp.userapi.com/c628016/v628016282/4e4b8/F-oFFrXxHFQ.jpg",
  "width": 2560,
  "height": 1707,
  "text": "",
  "date": 1460306870,
  "access_key": "e01813d38611ec7bbb"
}, {
  "id": 407971891,
  "album_id": 229404631,
  "owner_id": 5445842,
  "photo_75": "https://pp.userapi.com/c630630/v630630842/1ea14/FEXfzBIB-QA.jpg",
  "photo_130": "https://pp.userapi.com/c630630/v630630842/1ea15/GM1x5g7F220.jpg",
  "photo_604": "https://pp.userapi.com/c630630/v630630842/1ea16/5qRA3gG4WgA.jpg",
  "photo_807": "https://pp.userapi.com/c630630/v630630842/1ea17/VkzAYqo5Jtw.jpg",
  "photo_1280": "https://pp.userapi.com/c630630/v630630842/1ea18/Kgycd_AjApw.jpg",
  "width": 1280,
  "height": 856,
  "text": "",
  "date": 1458311433,
  "access_key": "6dd13da583d2fbc57a"
}, {
  "id": 407971872,
  "album_id": 229404631,
  "owner_id": 5445842,
  "photo_75": "https://pp.userapi.com/c630630/v630630842/1e9f9/DCO2iweQYXc.jpg",
  "photo_130": "https://pp.userapi.com/c630630/v630630842/1e9fa/lQTeXyoEbf8.jpg",
  "photo_604": "https://pp.userapi.com/c630630/v630630842/1e9fb/veF2f9RdL-0.jpg",
  "photo_807": "https://pp.userapi.com/c630630/v630630842/1e9fc/K5WffxYNv_I.jpg",
  "photo_1280": "https://pp.userapi.com/c630630/v630630842/1e9fd/IQWQ-ht4gyE.jpg",
  "width": 685,
  "height": 1024,
  "text": "",
  "date": 1458311425,
  "access_key": "e1cf395240f8878326"
}, {
  "id": 407971732,
  "album_id": 229404631,
  "owner_id": 5445842,
  "photo_75": "https://pp.userapi.com/c630630/v630630842/1e960/CIS9Q2fX-pc.jpg",
  "photo_130": "https://pp.userapi.com/c630630/v630630842/1e961/rwZTTIMBwj4.jpg",
  "photo_604": "https://pp.userapi.com/c630630/v630630842/1e962/nCiy7J1ZfoM.jpg",
  "photo_807": "https://pp.userapi.com/c630630/v630630842/1e963/Y-ZRxt3XNHQ.jpg",
  "photo_1280": "https://pp.userapi.com/c630630/v630630842/1e964/puzKmdYbOHw.jpg",
  "width": 1280,
  "height": 856,
  "text": "",
  "date": 1458311378,
  "access_key": "5952e5439b90c8611b"
}, {
  "id": 407971737,
  "album_id": 229404631,
  "owner_id": 5445842,
  "photo_75": "https://pp.userapi.com/c630630/v630630842/1e969/BinGeEDmkfg.jpg",
  "photo_130": "https://pp.userapi.com/c630630/v630630842/1e96a/rn-mgWqsd40.jpg",
  "photo_604": "https://pp.userapi.com/c630630/v630630842/1e96b/qewH7XHlIvo.jpg",
  "photo_807": "https://pp.userapi.com/c630630/v630630842/1e96c/UW4N7_p_GTI.jpg",
  "photo_1280": "https://pp.userapi.com/c630630/v630630842/1e96d/iNesuOA6qso.jpg",
  "width": 685,
  "height": 1024,
  "text": "",
  "date": 1458311381,
  "access_key": "0e68781077891f0eca"
}]







function biggestImage(item) {
  var
    bigest,
    imagevars = ["photo_2560", "photo_1280", "photo_807", "photo_604", "photo_130", "photo_75"];

  for (var i=0; i < imagevars.length; i++) {
    if (imagevars[i] in item) {
      bigest = item[imagevars[i]];
      delete item[imagevars[i]];
      break;
    };
  };
  return bigest;
};

{/*
function imagePrepare(item) {
  var newitem = {};

  newitem.src = biggestImage(item);
  newitem.srcSet = [];
  newitem.srcSet.push(biggestImage(item) + " 1024w");
  newitem.srcSet.push(biggestImage(item) + " 800w");
  newitem.srcSet.push(biggestImage(item) + " 500w");

  if (item.width && item.height) {
    newitem.width = item.width;
    newitem.height = item.height;
  } else {
    var img = new Image();

    img.onload = function(){
      newitem.height = img.height;
      newitem.width = img.width;
      console.log(newitem.height, newitem.width)
      // code here to use the dimensions
    }

    img.src = newitem.src;
  }
  return newitem;
};
*/}


function imgSize(src) {
  return new Promise(function(resolve, reject) {
    var img = new Image();
    img.onload = function(){
      resolve (img);
    }
    img.src = src;
  });
};

function imagePrepare(item) {
  return new Promise(function(resolve, reject) {
    var newitem = {};

    newitem.src = biggestImage(item);
    newitem.srcSet = [];
    newitem.srcSet.push(biggestImage(item) + " 1024w");
    newitem.srcSet.push(biggestImage(item) + " 800w");
    newitem.srcSet.push(biggestImage(item) + " 500w");

    newitem.thumbnail = item.photo_130 || item.photo_75 || item.photo_604 || item.photo_807;

    imgSize(newitem.thumbnail)
      .then(function(img) {
        newitem.thumbnailHeight = img.height;
        newitem.thumbnailWidth = img.width;
        console.log(img.width, img.height)
        resolve (newitem);
      });
    resolve (newitem);
  });
}


{/*function imagearrPrepare(arr) {
  var newarr = [];
  for (var i=0; i < arr.length; i++) {
    imagePrepare(arr[i]).then((item) => newarr[i] = item).catch((err) => console.log(err));
  };
  console.log(newarr)
  return newarr;

};*/}

function imagearrPrepare(arr) {
  return new Promise(function(resolve, reject) {
    var ArrayOfPromises = arr.map(function(item){
      return imagePrepare(item);
    });
    var newarr = Promise.all(ArrayOfPromises)
      .then(function(results){
        console.log(results)
        newarr = results;
        return newarr;
      })
      .catch((err) => console.log(err));
    console.log("before resolve", newarr)
    resolve (newarr);
  });
};

function imageSetter(arr){
  imagearrPrepare(arr)
    .then(function(result) {
      console.log("setter", result)
      return result;
  });
}


export const PHOTOARR = imageSetter(PHOTOARRVK);
